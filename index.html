<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>My first Three.js app</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<script src="static/libs/three.js"></script>
		<script src="static/libs/dat.gui.min.js"></script>
		<script src="static/src/tools.js"></script>
		<script src="static/src/row.js"></script>
		<script>

			/***********************
				3D SET UP 
			************************/

			var scene;
			var camera;
			var renderer;

			var plane_W = 15;
			var padding = 20;
			var gridRowsArray;
			var rowZ = [0, (-1*(plane_W*1)), (-1*(plane_W*2)), (-1*(plane_W*3)), (-1*(plane_W*4))];

			function init() {

				scene = new THREE.Scene();

				camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.5, 1000 );
				camera.position.z = 40;
				camera.position.y = 30
				camera.rotation.x = -0.05;

				renderer = new THREE.WebGLRenderer();
				renderer.setSize( window.innerWidth, window.innerHeight );


				/***********************
					GRID SET UP 
				************************/
				var planeGeo 	= new THREE.PlaneGeometry( plane_W, (plane_W * 0.75), 1);
				var imgTexture 	= new THREE.TextureLoader().load("assets/img/girl_blonde3x4.jpg");
				var imgMat 		= new THREE.MeshBasicMaterial({color: 0xffffff, map:imgTexture});
				var plane 		= new THREE.Mesh(planeGeo, imgMat);
				var participants = 14;
				var participantArray = [];

				var even = 4;
				var odd = (even - 1);
				var offset = plane_W/2;
					
				gridRowsArray = [
					row = new Row(4, padding, plane_W, rowZ[1]),
					row = new Row(3, padding, plane_W, rowZ[2]),
					row = new Row(4, padding, plane_W, rowZ[3]),
					row = new Row(3, padding, plane_W, rowZ[4])
				];

				console.log( "gridRowsArray");
				for ( i in gridRowsArray) {
					var row = gridRowsArray[i];
					console.log( row );
				}
				
				/********************************************
					 - populate grid with Avatars 
					 - set Avatar coords to match coords of slots in grid 
				***********************************************/ 

				for (i = 0; i < gridRowsArray.length; i++ ) {

					var row = gridRowsArray[i];

					for (k = 0; k < row.length; k++ ) {
						row[k].avatar = new THREE.Mesh(planeGeo, imgMat); 
						row[k].avatar.position.x = row[k].x;
						row[k].avatar.position.z = row[k].z;
						scene.add( row[k].avatar )
					}

		
				}

				document.body.appendChild( renderer.domElement );

				render();

				function render() {
					requestAnimationFrame( render );
					renderer.render(scene, camera);
				};

				
				// updateGrid();
			};

			window.onload = init;

			function onResize() {
		        camera.aspect = window.innerWidth / window.innerHeight;
		        camera.updateProjectionMatrix();
		        renderer.setSize(window.innerWidth, window.innerHeight);
		    }

		    window.addEventListener('resize', onResize, false);

		    /*********** 
				GUI 
		    ************/

		    function updateGrid() {
		    	console.log( "updateGrid");

		    	for ( i in gridRowsArray) {
		    		
		    		var row = gridRowsArray[i];

		    		row.padding = params.padding;
		    		row.itemWidth = plane_W;
		    		// row.zPos = rowZ[i+1];
		    		row.update()
		    	}
		    }


		    var params = {
		    	padding: padding
		    }

		    var gui = new dat.GUI()
		    gui.add( params, 'padding').min(0).max(30).step(1).onChange( updateGrid );



		</script>
	</body>
</html>